\mainmatter
\fancyfoot[EC,OC]{\hspace*{1 em}\thepage{}\hspace*{1 em}}
\normalsize
\fancypagestyle{plain}{\pagestyle{fancy}}
%\chapter[引言]{引言}\fancyhead[C]{\xiaowuhao 浙江工商大学硕士学位论文} %上传到系统里面的论文电子最终版本不要出现页眉（就是每一页的最顶端不要再写浙江工商大学了）
\chapter[引言]{引言}\fancyhead[C]{\xiaowuhao} %上传到系统里面的论文电子最终版本不要出现页眉（就是每一页的最顶端不要再写浙江工商大学了）
\section{选题背景与研究意义}
\subsection{选题背景}
除图像、视频，音频与自然语言处理等领域，AI技术的快速发展也带动相关交叉学科的发展。AI4Science近年在计算生物、计算化学、材料设计、计算天文，计算育种等都有广泛应用，相关AI技术的应用能够大幅加速相关科学研究进展。在计算制药领域，近年来相关AI技术在药物性质预测，生成，开发，实验等领域的运用不仅加速相关研究的进展，也能够降低相关研究的研发成本。

基于AI的生成模型近十年来也被广泛研究，他们包括变分自编码器（Variational autoencoders / VAEs）\cite{vae_kingma_13}，生成对抗模型（Generative adversarial networks / GANs）\cite{gan_goodfellow_14}，流形模型（Normalizing flows / NFs）\cite{nice_dinh_15,density_dinh_17}，自回归（Autoregressive models / ARs）\cite{ar_oord_16}与扩散模型（Diffusion）\cite{deepunsupervised_dickstein_15,generative_song_19}等。相关方法在图像，文字等方面也有了许多成功应用。

深度学习在分子化学领域近年来也有着成功的应用。以分子学习为例，化学分子常以简化分子线性输入规范字符串（Simplified molecular-input line-entry system / SMILES）\cite{smiles_weinberger_88}存储，每一个分子式对应一个SMILES字符串。随着早期深度学习方法，如卷积神经网络（Convolutional neural networks / CNNs）\cite{cnnsmiles_hirohara_18}和循环神经网络（Recurrent neural networks / RNNs）\cite{rnnsmiles_bjerrum_17,practicalmodel_liu_19,deeppurpose_huang_20}的发展，一些研究试图运用这些深度学习算法，对以字符串形式存在的分子式进行学习，以获得预测特定原子或是分子整体的性质的能力。随着图神经网络（Graph neural networks / GNNs）\cite{semisupervised_kipf_17,inductive_hamilton_17,howpowerful_xu_18}的出现，其对非结构化数据的建模能力和对节点间拓扑关系学习的能力被证明十分优异。分子作为自然界中天然存在的图结构，原子和键对应着图中的节点和边，这为分子学习提供了新的思路与方法。从最早的图卷积神经网络开始，相关研究者致力于提出新的图学习算法，以提升对分子图学习的性能。随着相关化学模拟技术的发展，让三维分子建模成为可能。这也在拓扑结构信息以外，提供了更丰富的几何构型信息，这也驱动着相关研究拓展至几何图神经网络上。分子三维构象允许研究者对分子进行更准确的研究，同时也推动更多复杂任务的出现，包括分子生成，Ligand生成，Protacs生成，药物亲和力预测，蛋白质预测等等。

\subsection{研究意义}
人工智能在智能计算相关研究中开始扮演越来越重要的角色，相关模型在药物发现、药物属性预测等应用中已经展现出良好的性能和极大的潜力。由于深度学习技术应用具备为药物研发的多阶段降本增效的潜力，在2022年，AI制药赛道相关企业融资总金额达百亿美元。在这一赛道竞逐的有国内互联网巨头如百度百图生科、华为EIHealth、腾讯云深智药，及初创企业晶泰科技，剂泰医药，星药科技等。相关成果已经展现出深度学习在该领域的强大性能和广阔前景。

\section{文献综述}
\subsection{基于深度学习的分子学习}
分子最早被表示为简化分子线性输入规范字符串（SMILES）\cite{smiles_weinberger_88}，随着早期深度学习模型卷积神经网络（CNN）和循环神经网络（RNN）的发展，相关模型利用CNNs和RNNs对分子性质做出学习。Hirohara等\cite{cnnsmiles_hirohara_18}的研究提出使用CNN对分子级别的特征和分子基团性质进行有效学习。由于RNNs在早期自然语言护理任务上有良好表现，Bjerrum\cite{rnnsmiles_bjerrum_17}提出LSTM-QSAR模型用于学习分子性质。

伴随图神经网络（GNNs）的发展，由于分子的形式天然的属于图结构，一些研究开始使用GNNs进行分子学习。CGCNN\cite{cgcnn_xie_18}将图卷积神经网络引入到分子性质学习，用以模拟并替代复杂的DFT计算。Xiong等\cite{attentivefp_xiong_20}提出Attentive FP，一个结合注意力机制的图神经网络实现分子性质的有效学习与预测。GraSeq\cite{graseq_guo_20}提出在运用图神经网络学习拓扑结构同时，利用双向LSTM模型对SMILES分子式进行学习，通过两个通道联合预测分子性质。伴随相关技术的发展，研究者可以不再拘泥于原子拓扑结构，进而实现对分子三维结构的建模与学习。鉴于某一分子对应大量的同分异构体，而不同构象对应属性不尽相同，因此对三维构象的有效学习是十分必要的。EGNN\cite{egnn_satorras_21}在流行的图网络基础上，保留最基本的几何信息，即原子间距离，其简单的设计也成为了一些。在分子预训练框架GEM\cite{gem_fang_22}中，研究者提出GeoGNN图网络，将键长视作原子节点图的边特征，又对原子键构图，并将键角作为原子键图的边特征，通过在两个网络上的信息传递实现分子局部空间几何性质学习。Sch\"{u}tt等\cite{schnet_schutt_17}在继承GNNs的信息传递范式的同时，将原子间距离用径向基函数（Radial basis funciton / RBF）建模后融入边特征，使算法对三维几何信息的有效学习的同时保证了等变性要求。SphereNet\cite{spherenet_liu_22}提出了基于球坐标系的信息传递范式SMP。通过一系列参考原子或键的规则，SMP在保证对原子对距离，键角和键扭转角这三个空间几何信息完整提取的同时，避免计算复杂度的爆炸式增长。ComENet\cite{comenet_wang_22}在ShpereNet的基础上，简化了空间几何信息的提取范式，在保证利用完整空间信息的前提下，以损失部分精度为代价，大幅度提升计算速度。

伴随着Transformer\cite{transformer_vaswani_17}相关研究在图像与文本领域的兴起，相关研究\cite{smilestrans_honda_19,smilesbert_wang_19,chemberta_chithrananda_20}也利用Transformer对SMILES分子式进行学习。随着GTN\cite{gtn_yun_19}将Transformer引入图学习，越来越多的研究也将多头注意力机制用于分子图学习领域。大规模分子图预训练框架GROVER\cite{grover_rong_20}中，分子学习内核运用了GTransformer，同时学习分子中的原子与键的节点嵌入（embedding）或边嵌入。在分子预训练框架MPG\cite{mpg_li_21}中提出的图学习内核MolGNet放弃了对边嵌入的学习，仅利用多头注意力学习节点嵌入，结果证明了该图学习算法的有效性。

\subsection{基于深度生成模型的分子设计}
自深度学习研究兴起以来，深度生成模型一直是研究者重点研究的对象。作画、翻译、对话，渲染等应用能够直接服务于广大用户。主流的深度生成模型有变分自编码器（Variational autoencoders / VAEs）\cite{vae_kingma_13}，生成对抗模型（Generative adversarial networks / GANs）\cite{gan_goodfellow_14}，流形模型（Normalizing flows / NFs）\cite{nice_dinh_15,density_dinh_17}，自回归（Autoregressive models / ARs）\cite{ar_oord_16}与扩散模型（Diffusion）\cite{deepunsupervised_dickstein_15,generative_song_19}等。

与图学习的演进过程相似，基于深度生成模型的分子设计也经历了从二维图结构到三维几何构象的演进。主流分子设计任务具体又可以被细分为：分子生成，分子优化，构象生成，蛋白质配体生成，蛋白质生成，蛋白降解靶向嵌合体生成。

分子生成的任务就是根据给定分子数据，使模型具备凭空生成全新且有效的药物分子。

现有的基于扩散的分子生成模型有且只有EDM\cite{edm_hoogeboom_22}和MDM\cite{mdm_huang_22}。
 
\section{创新点}
本文聚焦于扩散模型在分子生成领域的前沿研究，意在提出一个能够设计出有效、稳定分子的生成模型框架。本文利用扩散模型作为生成框架的骨架，在扩散模型的去噪内核设计上，本文提出了一个全新的图学习算法。该算法能够对几何信息，拓扑信息和原子化学性质进行分别建模，在保证模型等变形的条件下，实现对多种信息的有效学习与利用。

\section{基本框架}